# Extract ALL MCQs - Quick Reference

## üéØ What Changed?

Added a checkbox "Extract ALL MCQs from PDF" to the admin form that lets you extract every MCQ from a PDF without specifying a number.

## üìã Form Fields (In Order)

```
1. Chapter (Optional)           ‚Üí Select 1-41 or leave blank
2. Difficulty Level (Required)  ‚Üí Easy | Medium | Hard
3. ‚òë Extract ALL MCQs           ‚Üí NEW CHECKBOX
4. Number of MCQs               ‚Üí Ignored if #3 checked, use if #3 unchecked
5. Page From (Optional)         ‚Üí Start page (0 for beginning)
6. Page To (Optional)           ‚Üí End page
```

## ‚úÖ How to Use

### To Extract ALL MCQs:
1. **Check** the "Extract ALL MCQs from PDF" box
2. **Set** Difficulty Level
3. Click **Submit**
‚Üí Result: ALL MCQs from PDF extracted

### To Extract Specific Number:
1. **Uncheck** the "Extract ALL MCQs from PDF" box
2. **Enter** number in "Number of MCQs" (e.g., 10, 25, 50)
3. **Set** Difficulty Level
4. Click **Submit**
‚Üí Result: Exactly that many MCQs generated

## üîß Technical Details (Behind the Scenes)

| Component | Change |
|-----------|--------|
| Form Field | Added `extract_all` BooleanField |
| Admin Logic | If extract_all checked ‚Üí set num_items to 999999 |
| PDF Processor | If num_items == 999999 ‚Üí Tell LLM "Extract ALL" |
| LLM Prompt | Shows "Extract ALL questions" instead of "Generate N questions" |
| Database | Stores num_items = 999999 to track "extract all" requests |
| Console Output | Shows "Mode: EXTRACT ALL MCQs from PDF" |

## üìä Examples

### Example 1: Extract Everything
```
Form:
- Difficulty: Medium
- ‚òë Extract ALL MCQs from PDF
- Number of MCQs: (ignored)

Result:
All MCQs from the PDF are extracted with Medium difficulty level
```

### Example 2: Generate Exactly 20
```
Form:
- Difficulty: Hard
- ‚òê Extract ALL MCQs from PDF
- Number of MCQs: 20

Result:
Exactly 20 UPSC-level MCQs are generated
```

### Example 3: Extract All from Pages 5-15
```
Form:
- Difficulty: Easy
- ‚òë Extract ALL MCQs from PDF
- Page From: 5
- Page To: 15

Result:
All MCQs from pages 5-15 are extracted with Easy language
```

## üß™ Files Modified

1. **genai/admin.py**
   - Added `extract_all` checkbox to ProcessPDFForm
   - Updated processing logic to handle the checkbox
   - Updated debug output

2. **genai/tasks/pdf_processor.py**
   - Updated `generate_mcq_prompt()` to detect 999999 marker
   - Updated prompt formatting to convert 999999 to "ALL"
   - Updated console output to show "EXTRACT ALL MCQs" mode

## üìù Test Results

‚úÖ All tests passed:
- Form field structure correct
- Boolean field works properly
- Validation passes
- 999999 marker correctly detected
- Prompt text changes correctly
- Conversion logic works
- Console output shows mode correctly

## ‚öôÔ∏è How It Works (Flow)

```
User checks "Extract ALL MCQs"
         ‚Üì
Admin form processes checkbox
         ‚Üì
Sets num_items = 999999 (internal marker)
         ‚Üì
Creates ProcessingLog with num_items=999999
         ‚Üì
PDF Processor receives num_items=999999
         ‚Üì
Converts 999999 to "ALL" for LLM
         ‚Üì
Updates prompt: "Extract ALL multiple choice questions"
         ‚Üì
LLM processes and returns all MCQs
         ‚Üì
Saves all MCQs to subject table
```

## üéì Use Cases

| Scenario | Action | Result |
|----------|--------|--------|
| Need all MCQs from PDF | Check "Extract ALL" | Get everything |
| Want 5 MCQs | Uncheck, enter 5 | Get exactly 5 |
| Want 50 MCQs | Uncheck, enter 50 | Get exactly 50 |
| Specific pages only | Set Page From/To + Extract ALL | Get all from range |
| Different difficulty | Select difficulty level | Questions match level |

## üí° Tips

1. **Check console output** to see if "Mode: EXTRACT ALL MCQs" appears
2. **Look for "Content Type: MCQ"** to confirm dual-mode detection worked
3. **Use page range** with Extract ALL to limit scope if needed
4. **Difficulty still applies** even in extract all mode (simplifies language)

## ‚ùì FAQ

**Q: Why is "Number of MCQs" still there if it's ignored?**
A: For easy switching - uncheck Extract ALL and use that field when needed.

**Q: Can I extract ALL with page limits?**
A: Yes! Set Page From/To, check Extract ALL - gets all from that range.

**Q: Will it really extract EVERY MCQ?**
A: Yes, if the PDF is detected as MCQ format. Check "Content Type: MCQ" in console.

**Q: What if I want a specific number?**
A: Uncheck "Extract ALL" and enter the number in "Number of MCQs" field.

---

**Status:** ‚úÖ Ready for Production
**Date:** January 27, 2026
